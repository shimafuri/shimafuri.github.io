webpackJsonp([1],[,,,,,,,,,function(e,t,r){function n(e){r(19)}var a=r(2)(r(14),r(33),n,"data-v-34cb99e8",null);e.exports=a.exports},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),a=r(9),s=r.n(a);new n.a({el:"#app",template:'\n    <div style="\n      border: 32px solid transparent;\n      width: 1280px;\n      margin: 32px auto 0 auto;\n    ">\n      <div style="\n        width: 1280px;\n        height: 720px;\n        display: flex;\n        margin: 0 auto;\n        justify-content: center;\n        align-items: center;\n        position: relative;\n        ">\n        <Scene />\n      </div>\n    </div>\n  ',components:{Scene:s.a}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=function(e,t,r,n,a){return{x:e/2+r*n,y:t/2-r*a}};t.default={props:["shapes","colorCSS","acceptableErrorLength"],methods:{convertToSvgPoints:function(e,t,r,n){return n.map(function(n){var s=a(e,t,r,n[0],n[1]);return s.x+","+s.y}).join(" ")},convertToSvgPath:function(e,t,s,o){var c=o.map(function(r){switch(r.type){case n.a.MOVE_TO:if(r.relative)throw new Error("Relative coordinates are not supported.");var o=a(e,t,s,r.x,r.y);return{type:n.a.MOVE_TO,x:o.x,y:o.y};case n.a.LINE_TO:if(r.relative)throw new Error("Relative coordinates are not supported.");var c=a(e,t,s,r.x,r.y);return{type:n.a.LINE_TO,x:c.x,y:c.y};case n.a.SMOOTH_CURVE_TO:if(r.relative)throw console.warn("Unknown command type: "+r.type),new Error("Relative coordinates are not supported.");var i=a(e,t,s,r.x2,r.y2),p=a(e,t,s,r.x,r.y);return{type:n.a.SMOOTH_CURVE_TO,x2:i.x,y2:i.y,x:p.x,y:p.y};case n.a.CURVE_TO:if(r.relative)throw console.warn("Unknown command type: "+r.type),new Error("Relative coordinates are not supported.");var l=a(e,t,s,r.x1,r.y1),h=a(e,t,s,r.x2,r.y2),u=a(e,t,s,r.x,r.y);return{type:n.a.CURVE_TO,x1:l.x,y1:l.y,x2:h.x,y2:h.y,x:u.x,y:u.y};default:return r}});return r.i(n.b)(c)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),a=r.n(n),s=r(26),o=r.n(s),c=r(16),i=r.n(c),p=r(1),l=r(20),h=r(11),u=r.n(h),y=r(25),d=(r.n(y),r(30)),f=r.n(d),v=r(29),S=r.n(v),w=function(e,t,r){return l.a.add(l.a.create(),l.a.rotate(l.a.create(),l.a.fromValues(e,t),l.a.fromValues(0,0),r.rotate.amount),l.a.fromValues(r.translate.x,r.translate.y))},x=function(e,t){return e.map(function(e){switch(e.type){case"point":var r=w(e.x,e.y,t);return{type:"point",x:r[0],y:r[1]};case"line":var n=w(e.points.start.x,e.points.start.y,t),a=w(e.points.end.x,e.points.end.y,t);return{type:"line",points:{start:{x:n[0],y:n[1]},end:{x:a[0],y:a[1]}}};case"polyline":return{type:"polyline",points:e.points.map(function(e){return w(e[0],e[1],t)})};case"path":return{type:"path",svgCommands:e.svgCommands.map(function(e){switch(e.type){case p.a.MOVE_TO:if(e.relative)throw new Error("Relative coordinates are not supported.");var r=w(e.x,e.y,t);return{type:p.a.MOVE_TO,x:r[0],y:r[1]};case p.a.LINE_TO:if(e.relative)throw new Error("Relative coordinates are not supported.");var n=w(e.x,e.y,t);return{type:p.a.LINE_TO,x:n[0],y:n[1]};case p.a.CURVE_TO:if(e.relative)throw new Error("Relative coordinates are not supported.");var a=w(e.x1,e.y1,t),s=w(e.x2,e.y2,t),o=w(e.x,e.y,t);return{type:p.a.CURVE_TO,x1:a[0],y1:a[1],x2:s[0],y2:s[1],x:o[0],y:o[1]};case p.a.SMOOTH_CURVE_TO:if(e.relative)throw new Error("Relative coordinates are not supported.");var c=w(e.x2,e.y2,t),i=w(e.x,e.y,t);return{type:p.a.SMOOTH_CURVE_TO,x2:c[0],y2:c[1],x:i[0],y:i[1]};default:return console.warn("Unknown command type: "+e.type),e}})};default:throw new Error("Unknown shape type")}})},m=function(e){var t=e.from,r=e.to,n=e.duration,a=e.easing,s=e.onUpdate,o=e.onComplete,c=void 0,i=function e(t){u.a.update(t),c=requestAnimationFrame(e)};new u.a.Tween(t).to(r,n).easing(a).onUpdate(s).onComplete(function(){o(),cancelAnimationFrame(c)}).start(),c=requestAnimationFrame(i)},_=function(e,t,r,n,a){return{x:e/2+r*n,y:t/2-r*a}},g=function(e,t,r,n,a){return{x:(n-e/2)/r,y:-(a-t/2)/r}},C=new y.Howl({src:["static/pop.wav"]}),k=new y.Howl({src:["static/pop.wav"]});t.default={data:function(){return{phase:"MEMORYING",unitCircle:!0,aaaaa:50,bbbbb:50,session:{problems:[{hintShapes:[],correctShapes:[],tweeningTransform:{},tweeningHintShapes:[],tweeningCorrectShapes:[],transform:{translate:{x:0,y:0},rotate:{amount:0}},projectedHintShapes:[],projectedCorrectShapes:[],correctShapesColor:null,userAnswer:{strokes:[],canceledStrokes:[]},others:{}}],currentProblemIndex:0},isMouseDown:!1}},computed:{cp:function(){return this.session.problems[this.session.currentProblemIndex]},correctShapesColorCSS:function(){return new i.a({red:this.cp.correctShapesColor.red,green:this.cp.correctShapesColor.green,blue:this.cp.correctShapesColor.blue,alpha:this.cp.correctShapesColor.alpha}).toCSS()}},created:function(){this.resetSession()},mounted:function(){var e=this;window.addEventListener("keydown",function(t){t.keyCode===o()("space")&&(e.nextPhase(),t.preventDefault())}),window.addEventListener("keydown",function(t){t.ctrlKey&&t.keyCode===o()("z")&&(t.shiftKey?e.redo():e.undo(),t.preventDefault())})},watch:{phase:function(e,t){var r=this;switch(console.log(e+" "+t+" "),e){case"MEMORYING":this.resetSession();break;case"TRANSFORMING":this.cp.tweeningTransform={translate:{x:0,y:0},rotate:{amount:0}},m({from:this.cp.tweeningTransform.translate,to:this.cp.transform.translate,duration:500,easing:u.a.Easing.Quadratic.InOut,onUpdate:function(){r.updateShapes(r.cp)},onComplete:function(){r.cp.userAnswer.strokes.length=0,r.cp.userAnswer.canceledStrokes.length=0,r.phase="ANSWERING"}}),m({from:this.cp.tweeningTransform.rotate,to:this.cp.transform.rotate,duration:500,easing:u.a.Easing.Quadratic.InOut,onUpdate:function(){r.updateShapes(r.cp),r.$forceUpdate()},onComplete:function(){}}),m({from:this.cp.correctShapesColor,to:a.a.merge(a.a.clone(this.cp.correctShapesColor),{alpha:0}),duration:500,easing:u.a.Easing.Quadratic.Out,onUpdate:function(){},onComplete:function(){}});break;case"MARKING":a.a.merge(this.cp.correctShapesColor,{alpha:1})}switch(t){case"MEMORYING":e}}},methods:{scaleAndTranslate:_,resetSession:function(){this.cp.hintShapes.length=0,this.cp.correctShapes.length=0;var e=2*Math.PI*Math.random(),t=l.a.rotate(l.a.create(),l.a.fromValues(1,0),l.a.fromValues(0,0),e),r=l.a.rotate(l.a.create(),l.a.fromValues(1,0),l.a.fromValues(0,0),e+Math.PI),n=l.a.rotate(l.a.create(),l.a.fromValues(2*Math.random(),0),l.a.fromValues(0,0),2*Math.PI*Math.random()),s=l.a.rotate(l.a.create(),l.a.fromValues(2*Math.random(),0),l.a.fromValues(0,0),2*Math.PI*Math.random()),o=[{type:p.a.MOVE_TO,relative:!1,x:t[0],y:t[1]},{type:p.a.CURVE_TO,relative:!1,x1:n[0],y1:n[1],x2:s[0],y2:s[1],x:r[0],y:r[1]}];this.cp.hintShapes.push({type:"point",x:t[0],y:t[1]}),this.cp.hintShapes.push({type:"point",x:r[0],y:r[1]}),this.cp.correctShapes.push({type:"path",svgCommands:o}),this.cp.transform.translate.x=0,this.cp.transform.translate.y=0,this.cp.transform.rotate.amount=0,this.cp.transform.translate.x=(465/110-2)*(2*Math.random()-1),this.cp.transform.translate.y=1*(2*Math.random()-1),this.cp.tweeningHintShapes=a.a.cloneDeep(this.cp.hintShapes),this.cp.tweeningCorrectShapes=a.a.cloneDeep(this.cp.correctShapes),this.cp.projectedHintShapes=a.a.cloneDeep(this.cp.hintShapes),this.cp.projectedCorrectShapes=a.a.cloneDeep(this.cp.correctShapes),this.cp.correctShapesColor={red:0,green:0,blue:0,alpha:1}},updateShapes:function(e){a.a.merge(e.tweeningHintShapes,x(e.hintShapes,e.tweeningTransform)),a.a.merge(e.tweeningCorrectShapes,x(e.correctShapes,e.tweeningTransform)),a.a.merge(e.projectedHintShapes,e.tweeningHintShapes),a.a.merge(e.projectedCorrectShapes,e.tweeningCorrectShapes)},nextPhase:function(){switch(this.phase){case"MEMORYING":this.phase="TRANSFORMING";break;case"ANSWERING":this.phase="MARKING";break;case"MARKING":this.phase="MEMORYING"}},undo:function(){this.isMouseDown||this.cp.userAnswer.strokes.length>0&&this.cp.userAnswer.canceledStrokes.unshift(this.cp.userAnswer.strokes.pop())},redo:function(){this.isMouseDown||this.cp.userAnswer.canceledStrokes.length>0&&this.cp.userAnswer.strokes.push(this.cp.userAnswer.canceledStrokes.shift())},onMouseDown:function(e){switch(this.isMouseDown=!0,this.phase){case"ANSWERING":var t={points:[]};t.points.push(g(930,660,110,e.offsetX,e.offsetY)),C.play(),this.cp.userAnswer.strokes.push(t),this.cp.userAnswer.canceledStrokes.length=0}},onMouseMove:function(e){switch(this.aaaaa=e.offsetX,this.bbbbb=e.offsetY,this.phase){case"ANSWERING":if(this.isMouseDown){if(this.cp.userAnswer.strokes[this.cp.userAnswer.strokes.length-1].points.push(g(930,660,110,e.offsetX,e.offsetY)),k.playing()){var t=k.seek();(0===t||t>=.04)&&k.seek(0)}else k.play()}}},onMouseUp:function(e){this.isMouseDown=!1,this.phase}},components:{Shapes:f.a,AcceptableArea:S.a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=function(e,t,r,n,a){return{x:e/2+r*n,y:t/2-r*a}};t.default={props:["shapes","colorCSS"],methods:{convertToSvgPoints:function(e,t,r,n){return n.map(function(n){var s=a(e,t,r,n[0],n[1]);return s.x+","+s.y}).join(" ")},convertToSvgPath:function(e,t,s,o){var c=o.map(function(r){switch(r.type){case n.a.MOVE_TO:if(r.relative)throw new Error("Relative coordinates are not supported.");var o=a(e,t,s,r.x,r.y);return{type:n.a.MOVE_TO,x:o.x,y:o.y};case n.a.LINE_TO:if(r.relative)throw new Error("Relative coordinates are not supported.");var c=a(e,t,s,r.x,r.y);return{type:n.a.LINE_TO,x:c.x,y:c.y};case n.a.SMOOTH_CURVE_TO:if(r.relative)throw console.warn("Unknown command type: "+r.type),new Error("Relative coordinates are not supported.");var i=a(e,t,s,r.x2,r.y2),p=a(e,t,s,r.x,r.y);return{type:n.a.SMOOTH_CURVE_TO,x2:i.x,y2:i.y,x:p.x,y:p.y};case n.a.CURVE_TO:if(r.relative)throw console.warn("Unknown command type: "+r.type),new Error("Relative coordinates are not supported.");var l=a(e,t,s,r.x1,r.y1),h=a(e,t,s,r.x2,r.y2),u=a(e,t,s,r.x,r.y);return{type:n.a.CURVE_TO,x1:l.x,y1:l.y,x2:h.x,y2:h.y,x:u.x,y:u.y};default:return r}});return r.i(n.b)(c)}}}},,function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,function(e,t,r){function n(e){r(17)}var a=r(2)(r(13),r(31),n,null,null);e.exports=a.exports},function(e,t,r){function n(e){r(18)}var a=r(2)(r(15),r(32),n,null,null);e.exports=a.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("g",[e._l(e.shapes,function(t,n){return["point"===t.type?[r("circle",{key:n,style:{fill:e.colorCSS},attrs:{cx:465+110*t.x,cy:330-110*t.y,r:110*e.acceptableErrorLength}})]:e._e(),e._v(" "),"line"===t.type?[r("g",{key:n,style:{stroke:e.colorCSS}},[r("line",{attrs:{x1:465+110*t.points.start.x,y1:330-110*t.points.start.y,x2:465+110*t.points.end.x,y2:330-110*t.points.end.y,"stroke-width":110*e.acceptableErrorLength*2}})])]:e._e(),e._v(" "),"polyline"===t.type?[r("polyline",{key:n,style:{stroke:e.colorCSS},attrs:{fill:"none",points:e.convertToSvgPoints(930,660,110,t.points),"stroke-width":2*e.acceptableErrorLength*110}})]:e._e(),e._v(" "),"path"===t.type?[r("path",{key:n,style:{stroke:e.colorCSS},attrs:{fill:"none",d:e.convertToSvgPath(930,660,110,t.svgCommands),"stroke-width":2*e.acceptableErrorLength*110,"stroke-linecap":"round"}})]:e._e()]})],2)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("g",[e._l(e.shapes,function(t,n){return["point"===t.type?[r("circle",{key:n,style:{fill:e.colorCSS},attrs:{cx:465+110*t.x,cy:330-110*t.y,r:"3"}})]:e._e(),e._v(" "),"line"===t.type?[r("g",{key:n,style:{stroke:e.colorCSS}},[r("line",{attrs:{x1:465+110*t.points.start.x,y1:330-110*t.points.start.y,x2:465+110*t.points.end.x,y2:330-110*t.points.end.y,"stroke-width":"3"}})])]:e._e(),e._v(" "),"polyline"===t.type?[r("polyline",{key:n,style:{stroke:e.colorCSS},attrs:{fill:"none",points:e.convertToSvgPoints(930,660,110,t.points),"stroke-width":"3"}})]:e._e(),e._v(" "),"path"===t.type?[r("path",{key:n,style:{stroke:e.colorCSS},attrs:{fill:"none",d:e.convertToSvgPath(930,660,110,t.svgCommands),"stroke-width":"3"}})]:e._e()]})],2)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"root"},[r("div",{staticClass:"stage"},[r("div",{staticStyle:{position:"absolute",top:"0",right:"0",bottom:"0",width:"100%",height:"100%"},on:{mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseup:function(t){e.onMouseUp(t)}}},[r("svg",{style:{position:"absolute",top:"0",right:"0",bottom:"0",right:"0",width:"100%",height:"100%",cursor:"none"}},["MEMORYING"===e.phase?[e.unitCircle?r("circle",{attrs:{cx:465,cy:330,r:"220",fill:"transparent",stroke:"#cccccc","stroke-width":"0.5"}}):e._e(),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedHintShapes,colorCSS:"black"}}),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedCorrectShapes,colorCSS:"black"}})]:e._e(),e._v(" "),"TRANSFORMING"===e.phase?[e.unitCircle?r("circle",{attrs:{cx:465+110*e.cp.tweeningTransform.translate.x,cy:330-110*e.cp.tweeningTransform.translate.y,r:"220",fill:"transparent",stroke:"#cccccc","stroke-width":"0.5"}}):e._e(),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedHintShapes,colorCSS:"black"}}),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedCorrectShapes,colorCSS:e.correctShapesColorCSS}})]:e._e(),e._v(" "),"ANSWERING"===e.phase?[e.unitCircle?r("circle",{attrs:{cx:465+110*e.cp.transform.translate.x,cy:330-110*e.cp.tweeningTransform.translate.y,r:"220",fill:"transparent",stroke:"#cccccc","stroke-width":"0.5"}}):e._e(),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedHintShapes,colorCSS:"black"}}),e._v(" "),r("circle",{attrs:{cx:e.aaaaa,cy:e.bbbbb,r:"3",fill:"blue"}}),e._v(" "),e._l(e.cp.userAnswer.strokes,function(t){return[e._l(t.points,function(t,n){return[r("circle",{key:n,attrs:{cx:e.scaleAndTranslate(930,660,110,t.x,0).x,cy:e.scaleAndTranslate(930,660,110,0,t.y).y,r:"1.5",fill:"blue"}})]})]})]:e._e(),e._v(" "),"MARKING"===e.phase?[r("AcceptableArea",{attrs:{shapes:e.cp.projectedCorrectShapes,colorCSS:"rgb(240, 240, 240)",acceptableErrorLength:.1}}),e._v(" "),e.unitCircle?r("circle",{attrs:{cx:465+110*e.cp.tweeningTransform.translate.x,cy:330-110*e.cp.tweeningTransform.translate.y,r:"220",fill:"transparent",stroke:"#cccccc","stroke-width":"0.5"}}):e._e(),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedHintShapes,colorCSS:"black"}}),e._v(" "),r("Shapes",{attrs:{shapes:e.cp.projectedCorrectShapes,colorCSS:"black",acceptableErrorLength:.2}}),e._v(" "),e._l(e.cp.userAnswer.strokes,function(t){return[e._l(t.points,function(t,n){return[r("circle",{key:n,attrs:{cx:e.scaleAndTranslate(930,660,110,t.x,0).x,cy:e.scaleAndTranslate(930,660,110,0,t.y).y,r:"1.5",fill:"blue"}})]})]})]:e._e()],2)])]),e._v(" "),r("div",{staticClass:"debug-panel"},[r("input",{attrs:{type:"button",value:"Go to MEMORYING"},on:{click:function(t){e.phase="MEMORYING"}}}),r("br"),e._v(" "),r("input",{attrs:{type:"button",value:"Toggle unit circle"},on:{click:function(t){e.unitCircle=!e.unitCircle}}}),r("br"),e._v(" "),r("input",{attrs:{type:"button",value:"Reset session"},on:{click:function(t){e.resetSession()}}})]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"MEMORYING"===e.phase,expression:"phase === 'MEMORYING'"}],staticClass:"memoried-button",on:{click:function(t){e.nextPhase()}}},[e._v("おぼえた")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"ANSWERING"===e.phase,expression:"phase === 'ANSWERING'"}],staticClass:"memoried-button",on:{click:function(t){e.nextPhase()}}},[e._v("答える")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"MARKING"===e.phase,expression:"phase === 'MARKING'"}],staticClass:"memoried-button",on:{click:function(t){e.nextPhase()}}},[e._v("次の問題へ")]),e._v(" "),r("div",{staticClass:"phase-indicator"},[e._v(e._s(e.phase))])])},staticRenderFns:[]}}],[12]);
//# sourceMappingURL=app.cb4c0db7d93289873a52.js.map